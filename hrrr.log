2025-08-09 19:59:06,590 - config_unified - WARNING - Could not import existing config.py - using defaults
2025-08-09 19:59:06,595 - __main__ - INFO - 🚀 ENHANCED HRRR Data Extraction
2025-08-09 19:59:06,595 - __main__ - INFO - ==================================================
2025-08-09 19:59:06,595 - __main__ - INFO - Choose extraction type by commenting/uncommenting the lines below:
2025-08-09 19:59:06,595 - __main__ - INFO - 
2025-08-09 19:59:06,596 - __main__ - INFO - ✅ Configuration loaded and validated
2025-08-09 19:59:06,596 - __main__ - INFO - 🚀 TESTING REGION EXTRACTION WITH QUARTERLY DATA
2025-08-09 19:59:06,596 - __main__ - INFO - ==================================================
2025-08-09 19:59:06,604 - utils_enhanced - INFO - System Info:
2025-08-09 19:59:06,604 - utils_enhanced - INFO -   CPU cores: 36
2025-08-09 19:59:06,604 - utils_enhanced - INFO -   Memory: 251.4 GB total
2025-08-09 19:59:06,604 - utils_enhanced - INFO -   Memory available: 244.1 GB
2025-08-09 19:59:06,605 - utils_enhanced - INFO -   Platform: posix
2025-08-09 19:59:06,606 - __main__ - INFO - 📊 Test Regions:
2025-08-09 19:59:06,607 - __main__ - INFO -    spp_all: {'lat_min': 30.0, 'lat_max': 47.0, 'lon_min': -106.0, 'lon_max': -88.0, 'description': 'Southwest Power Pool complete footprint including WEIS and RTO regions'}
2025-08-09 19:59:06,607 - __main__ - INFO - 💾 Checking disk space...
2025-08-09 19:59:06,608 - utils_enhanced - WARNING - Could not check disk space: [Errno 2] No such file or directory: './test_regions_extracted'
2025-08-09 19:59:06,608 - __main__ - INFO - 📁 Creating output directories...
2025-08-09 19:59:06,615 - __main__ - INFO - 🔍 Validating data directory...
2025-08-09 19:59:15,614 - utils_enhanced - INFO - ✅ Found 212640 GRIB files in /research/alij/hrrr
2025-08-09 19:59:15,624 - __main__ - INFO - ✅ Using GRIB path: /research/alij/hrrr
2025-08-09 19:59:15,624 - __main__ - INFO - 📋 Test Parameters:
2025-08-09 19:59:15,624 - __main__ - INFO -    Date range: 2022-12-31 to 2023-01-01
2025-08-09 19:59:15,624 - __main__ - INFO -    Regions: ['spp_all']
2025-08-09 19:59:15,625 - __main__ - INFO -    Wind variables: ['UWind80', 'VWind80']
2025-08-09 19:59:15,625 - __main__ - INFO -    Solar variables: ['UWind10', 'VWind10', 'rad', 'vbd', 'vdd', '2tmp']
2025-08-09 19:59:15,625 - __main__ - INFO -    Workers: 36
2025-08-09 19:59:15,625 - utils_enhanced - INFO - Performance monitoring started
2025-08-09 19:59:16,974 - __main__ - INFO - 🚀 TESTING OPTIMIZED MULTI-REGION EXTRACTION WITH QUARTERLY RESOLUTION
2025-08-09 19:59:16,974 - __main__ - INFO - ==================================================
2025-08-09 19:59:16,974 - __main__ - INFO - 📊 Testing OPTIMIZED region-based extraction for quarterly data
2025-08-09 19:59:16,974 - __main__ - INFO -    - Each GRIB file read only ONCE for ALL regions and variables
2025-08-09 19:59:16,974 - __main__ - INFO -    - 90% reduction in I/O operations
2025-08-09 19:59:16,974 - __main__ - INFO -    - Quarter-hourly data (00, 15, 30, 45 minutes)
2025-08-09 19:59:16,974 - __main__ - INFO -    - Memory-efficient processing for large regions
2025-08-09 19:59:16,975 - region_extraction - INFO - 🚀 OPTIMIZED multi-region extraction for 1 regions
2025-08-09 19:59:16,975 - region_extraction - INFO -    Date range: 2022-12-31 to 2023-01-01
2025-08-09 19:59:16,975 - region_extraction - INFO -    🎯 SINGLE-PASS GRIB READING + MULTIPROCESSING - 90% faster!
2025-08-09 19:59:16,975 - region_extraction - INFO -    🔄 Parallel processing: 36 workers
2025-08-09 19:59:16,982 - region_extraction - INFO - 🔍 Getting grid metadata...
2025-08-09 19:59:17,337 - region_extraction - INFO -    Grid dimensions: 1059 x 1799
2025-08-09 19:59:17,337 - region_extraction - INFO - 🔍 Finding GRIB files...
2025-08-09 19:59:17,338 - region_extraction - INFO -    Found 50 GRIB files
2025-08-09 19:59:17,339 - region_extraction - INFO -    Variables to extract: ['UWind80', 'VWind80', 'UWind10', 'VWind10', 'rad', 'vbd', 'vdd', '2tmp']
2025-08-09 19:59:17,339 - region_extraction - INFO - 🔍 Pre-calculating grid points for all regions...
2025-08-09 19:59:17,339 - region_extraction - INFO - 🔍 Processing region: spp_all
2025-08-09 19:59:17,339 - region_extraction - INFO -    Using rectangular bounds
2025-08-09 19:59:17,354 - region_extraction - INFO -    ✅ spp_all: 330238 grid points
2025-08-09 19:59:17,354 - region_extraction - INFO -    Total grid points across all regions: 330238
2025-08-09 19:59:17,354 - region_extraction - INFO - 🔄 Processing 50 GRIB files with 36 parallel workers...
2025-08-09 19:59:18,355 - region_extraction - INFO -    CPU usage before multiprocessing: 0.1%
2025-08-09 19:59:39,333 - region_extraction - INFO -    CPU usage after multiprocessing: 0.4%
2025-08-09 19:59:39,333 - region_extraction - INFO -    Multiprocessing time: 20.0s
2025-08-09 19:59:39,334 - region_extraction - INFO - ✅ Processed 50/50 GRIB files with multiprocessing
2025-08-09 19:59:39,334 - region_extraction - INFO -    Success rate: 100.0%
2025-08-09 19:59:39,334 - region_extraction - INFO - 💾 Saving data for each region and variable with parallel processing...
2025-08-09 19:59:39,335 - region_extraction - INFO - 🔄 Processing 20 daily files (region+variable+day) with TRUE parallel saving...
2025-08-09 20:00:54,655 - region_extraction - INFO -    ✅ Saved WindSpeed10 for spp_all on 20221231: (96, 330238) (96 timestamps × 330238 grid points) [snappy, float32]
2025-08-09 20:00:54,656 - region_extraction - INFO -    ✅ Saved WindSpeed10 for spp_all on 20230101: (4, 330238) (4 timestamps × 330238 grid points) [snappy, float32]
2025-08-09 20:00:54,656 - region_extraction - INFO -    ✅ Saved 2tmp for spp_all on 20221231: (96, 330238) (96 timestamps × 330238 grid points) [snappy, int16_temp_scaled]
2025-08-09 20:00:54,656 - region_extraction - INFO -    ✅ Saved 2tmp for spp_all on 20230101: (4, 330238) (4 timestamps × 330238 grid points) [snappy, int16_temp_scaled]
2025-08-09 20:00:54,656 - region_extraction - INFO -    ✅ Saved vbd for spp_all on 20221231: (96, 330238) (96 timestamps × 330238 grid points) [snappy, int16_rad_scaled]
2025-08-09 20:00:54,656 - region_extraction - INFO -    ✅ Saved vbd for spp_all on 20230101: (4, 330238) (4 timestamps × 330238 grid points) [snappy, int16_rad_scaled]
2025-08-09 20:00:54,657 - region_extraction - INFO -    ✅ Saved VWind80 for spp_all on 20221231: (96, 330238) (96 timestamps × 330238 grid points) [snappy, float32]
2025-08-09 20:00:54,657 - region_extraction - INFO -    ✅ Saved VWind80 for spp_all on 20230101: (4, 330238) (4 timestamps × 330238 grid points) [snappy, float32]
2025-08-09 20:00:54,657 - region_extraction - INFO -    ✅ Saved UWind80 for spp_all on 20221231: (96, 330238) (96 timestamps × 330238 grid points) [snappy, float32]
2025-08-09 20:00:54,657 - region_extraction - INFO -    ✅ Saved UWind80 for spp_all on 20230101: (4, 330238) (4 timestamps × 330238 grid points) [snappy, float32]
2025-08-09 20:00:54,657 - region_extraction - INFO -    ✅ Saved VWind10 for spp_all on 20221231: (96, 330238) (96 timestamps × 330238 grid points) [snappy, float32]
2025-08-09 20:00:54,657 - region_extraction - INFO -    ✅ Saved VWind10 for spp_all on 20230101: (4, 330238) (4 timestamps × 330238 grid points) [snappy, float32]
2025-08-09 20:00:54,657 - region_extraction - INFO -    ✅ Saved vdd for spp_all on 20221231: (96, 330238) (96 timestamps × 330238 grid points) [snappy, int16_rad_scaled]
2025-08-09 20:00:54,657 - region_extraction - INFO -    ✅ Saved vdd for spp_all on 20230101: (4, 330238) (4 timestamps × 330238 grid points) [snappy, int16_rad_scaled]
2025-08-09 20:00:54,657 - region_extraction - INFO -    ✅ Saved UWind10 for spp_all on 20221231: (96, 330238) (96 timestamps × 330238 grid points) [snappy, float32]
2025-08-09 20:00:54,657 - region_extraction - INFO -    ✅ Saved UWind10 for spp_all on 20230101: (4, 330238) (4 timestamps × 330238 grid points) [snappy, float32]
2025-08-09 20:00:54,657 - region_extraction - INFO -    ✅ Saved WindSpeed80 for spp_all on 20221231: (96, 330238) (96 timestamps × 330238 grid points) [snappy, float32]
2025-08-09 20:00:54,658 - region_extraction - INFO -    ✅ Saved WindSpeed80 for spp_all on 20230101: (4, 330238) (4 timestamps × 330238 grid points) [snappy, float32]
2025-08-09 20:00:54,658 - region_extraction - INFO -    ✅ Saved rad for spp_all on 20221231: (96, 330238) (96 timestamps × 330238 grid points) [snappy, int16_rad_scaled]
2025-08-09 20:00:54,658 - region_extraction - INFO -    ✅ Saved rad for spp_all on 20230101: (4, 330238) (4 timestamps × 330238 grid points) [snappy, int16_rad_scaled]
2025-08-09 20:00:54,658 - region_extraction - INFO - ✅ Parallel saving completed: 20/20 files saved successfully
2025-08-09 20:00:54,658 - region_extraction - INFO - 🗺️  Creating grid mapping files for each region...
2025-08-09 20:00:56,048 - region_extraction - INFO -    ✅ Created mapping for spp_all: 330,238 grid points -> /research/alij/test_regions_extracted/spp_all/mappings/spp_all_grid_mapping.parquet
2025-08-09 20:00:56,048 - region_extraction - INFO - 
✅ OPTIMIZED multi-region extraction completed!
2025-08-09 20:00:56,048 - region_extraction - INFO -    Total time: 99.1s
2025-08-09 20:00:56,048 - region_extraction - INFO -    Files processed: 50
2025-08-09 20:00:56,048 - region_extraction - INFO -    Successful regions: 1
2025-08-09 20:00:56,048 - region_extraction - INFO -    Failed regions: 0
2025-08-09 20:00:56,049 - region_extraction - INFO -    Total grid points: 330238
2025-08-09 20:00:56,049 - region_extraction - INFO -    🚀 Efficiency: Single-pass GRIB reading + multiprocessing achieved!
2025-08-09 20:00:56,100 - utils_enhanced - INFO - Operation completed: 100.5s, 0.50 files/s, 3286.79 points/s
2025-08-09 20:00:56,100 - __main__ - INFO - ✅ Test region extraction completed!
2025-08-09 20:00:56,100 - __main__ - INFO - 
📁 TEST EXTRACTION SUMMARY
2025-08-09 20:00:56,100 - __main__ - INFO - ========================================
2025-08-09 20:00:56,101 - __main__ - INFO - 📊 Test region directories: 0 in ./test_regions_extracted/
2025-08-09 20:00:56,101 - __main__ - INFO -    Total files: 0
2025-08-09 20:00:56,101 - __main__ - INFO -    Total size: 0.0 MB
2025-08-09 20:00:56,101 - __main__ - INFO - 📊 Test Processing Summary:
2025-08-09 20:00:56,101 - __main__ - INFO -    Total regions: 1
2025-08-09 20:00:56,101 - __main__ - INFO -    Successful regions: 1
2025-08-09 20:00:56,101 - __main__ - INFO -    Failed regions: 0
2025-08-09 20:00:56,101 - __main__ - INFO -    Total grid points: 330238
2025-08-09 20:00:56,101 - __main__ - INFO -    Processing time: 0.0 hours
2025-08-09 20:00:56,101 - __main__ - INFO - 📈 Test Performance Summary:
2025-08-09 20:00:56,101 - __main__ - INFO -    Total duration: 1.7m
2025-08-09 20:00:56,102 - __main__ - INFO -    Avg throughput: 0.50 files/s
2025-08-09 20:00:56,102 - __main__ - INFO -    Peak memory: 13.5 GB
2025-08-09 20:00:56,102 - __main__ - INFO -    Avg CPU: 24.7%
2025-08-09 20:00:56,102 - __main__ - INFO - 
✅ Enhanced extraction completed successfully!
2025-08-09 20:00:56,102 - __main__ - INFO - 🎯 Final Performance Summary:
2025-08-09 20:00:56,102 - __main__ - INFO -    Total time: 1.7m
2025-08-09 20:00:56,102 - __main__ - INFO -    Throughput: 0.50 files/s
2025-08-09 20:00:56,102 - __main__ - INFO -    Memory peak: 13.5 GB
2025-08-09 20:00:56,102 - __main__ - INFO -    CPU usage: 24.7%
